<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SIR model for the spread of COVID-19 · Agents.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Agents.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">Agents.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><a class="tocitem" href="../../tutorial/">Tutorial</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../schelling/">Schelling&#39;s segregation model</a></li><li class="is-active"><a class="tocitem" href>SIR model for the spread of COVID-19</a><ul class="internal"><li><a class="tocitem" href="#SIR-model-1"><span>SIR model</span></a></li><li><a class="tocitem" href="#Model-parameters-1"><span>Model parameters</span></a></li><li><a class="tocitem" href="#Making-the-model-in-Agents.jl-1"><span>Making the model in Agents.jl</span></a></li><li><a class="tocitem" href="#SIR-Stepping-functions-1"><span>SIR Stepping functions</span></a></li><li><a class="tocitem" href="#Example-animation-1"><span>Example animation</span></a></li><li><a class="tocitem" href="#Exponential-growth-1"><span>Exponential growth</span></a></li></ul></li><li><a class="tocitem" href="../wealth_distribution/">Wealth distribution</a></li><li><a class="tocitem" href="../forest_fire/">Forest fire</a></li><li><a class="tocitem" href="../game_of_life_2D_CA/">Game of life</a></li><li><a class="tocitem" href="../rule22_1D_CA/">Rule 22</a></li><li><a class="tocitem" href="../wright-fisher/">Wright-Fisher model of evolution</a></li><li><a class="tocitem" href="../HK/">Hegselmann-Krause opinion dynamics</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li><li><a class="tocitem" href="../../mesa/">Comparison against Mesa (Python)</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>SIR model for the spread of COVID-19</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SIR model for the spread of COVID-19</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaDynamics/Agents.jl/blob/master/examples/sir.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="SIR-model-for-the-spread-of-COVID-19-1"><a class="docs-heading-anchor" href="#SIR-model-for-the-spread-of-COVID-19-1">SIR model for the spread of COVID-19</a><a class="docs-heading-anchor-permalink" href="#SIR-model-for-the-spread-of-COVID-19-1" title="Permalink"></a></h1><h2 id="SIR-model-1"><a class="docs-heading-anchor" href="#SIR-model-1">SIR model</a><a class="docs-heading-anchor-permalink" href="#SIR-model-1" title="Permalink"></a></h2><p>SIR model tracks the ratio of Susceptible, Infected, and Recovered individuals within a population. Here we add one more category of individuals: those who are infected, but do not know it. Transmission rate of infected and diagnosed is lower than infected and undetected. We also allow a fraction of recovered individuals to catch the disease again, meaning that recovering the disease does not bring full immunity.</p><h2 id="Model-parameters-1"><a class="docs-heading-anchor" href="#Model-parameters-1">Model parameters</a><a class="docs-heading-anchor-permalink" href="#Model-parameters-1" title="Permalink"></a></h2><p>Here are the model parameters, some of which have default values.</p><ul><li><code>Ns</code>: a vector of population sizes per city. The amoount of cities is just <code>C=length(Ns)</code>.</li><li><code>β_und</code>: a vector for transmission probabilities β of the infected but undetected per city. Transmission probability is how many susceptiple are infected per day by an infected individual. If social distancing is practiced, this number increases.</li><li><code>β_det</code>: an array for transmission probabilities β of the infected and detected per city. If hospitals are full, this number increases.</li><li><code>infection_period = 30</code>: how many days before a person dies or recovers.</li><li><code>detection_time = 14</code>: how many days before an infected person is detected.</li><li><code>death_rate = 0.02</code>: the probability that the individual will die after the <code>infection_period</code>.</li><li><code>reinfection_probability = 0.05</code>: The probabiity that a recovered person can get infected again.</li><li><code>migration_rates</code>: A matrix of migration probability per individual per day from one city to another.</li><li><code>Is = [zeros(C-1)..., 1]</code>: An array for initial number of infected but undetected people per city. This starts as only one infected individual in the last city.</li></ul><p>Notice that all <code>Ns, β, Is</code> need to have the same length, as they are numbers for each city. We&#39;ve tried to add values to the infection parameters similar to the ones you would hear on the news about COVID-19.</p><p>The good thing with Agent based models is that you could easily extend the model we implement here to also include age as the agent&#39;s property. This makes ABMs flexible and suitable for research of virus spreading.</p><h2 id="Making-the-model-in-Agents.jl-1"><a class="docs-heading-anchor" href="#Making-the-model-in-Agents.jl-1">Making the model in Agents.jl</a><a class="docs-heading-anchor-permalink" href="#Making-the-model-in-Agents.jl-1" title="Permalink"></a></h2><p>We start by defining the <code>PoorSoul</code> agent type and the ABM</p><pre><code class="language-julia">using Agents, Random, DataFrames, LightGraphs
using Distributions: Poisson, DiscreteNonParametric
using DrWatson: @dict
using Plots

mutable struct PoorSoul &lt;: AbstractAgent
    id::Int
    pos::Int
    days_infected::Int  # number of days since is infected
    status::Symbol  # 1: S, 2: I, 3:R
end

function model_initiation(;Ns, migration_rates, β_und, β_det, infection_period = 30,
	reinfection_probability = 0.05, detection_time = 14, death_rate = 0.02,
	Is=[zeros(Int, length(Ns)-1)..., 1], seed = 0)

    Random.seed!(seed)
    @assert length(Ns) == length(Is) == length(β_und) == length(β_det) == size(migration_rates, 1) &quot;length of Ns, Is, and B, and number of rows/columns in migration_rates should be the same &quot;
    @assert size(migration_rates, 1) == size(migration_rates, 2) &quot;migration_rates rates should be a square matrix&quot;

    C = length(Ns)
    # normalize migration_rates
    migration_rates_sum = sum(migration_rates, dims=2)
    for c in 1:C
        migration_rates[c, :] ./= migration_rates_sum[c]
    end

	properties =
		@dict(Ns, Is, β_und, β_det, β_det, migration_rates, infection_period,
		infection_period, reinfection_probability, detection_time, C, death_rate)
	space = Space(complete_digraph(C))
    model = ABM(PoorSoul, space; properties=properties)

    # Add initial individuals
    for city in 1:C, n in 1:Ns[city]
        ind = add_agent!(city, model, 0, :S) # Susceptible
    end
    # add infected individuals
    for city in 1:C
        inds = get_node_contents(city, model)
        for n in 1:Is[city]
            agent = id2agent(inds[n], model)
            agent.status = :I # Infected
            agent.days_infected = 1
        end
    end
    return model
end

params = Dict(
    :Ns =&gt; [5000, 2000, 1000],
	# Transmission rates of the virus are generally a bit higher in more
	# crowded cities (we assume people have a more &quot;outgoing&quot; lifestyle there)
    :β_und =&gt; [0.7, 0.6, 0.5],
    :β_det =&gt; [0.08, 0.06, 0.04],
    # people from smaller cities are more likely to travel to bigger cities.
    :migration_rates =&gt; [1      0.01   0.005;
	                     0.015  1      0.007;
						 0.02   0.018  1],
)

model = model_initiation(;params...)</code></pre><pre><code class="language-none">AgentBasedModel with 8000 agents of type PoorSoul
 space: GraphSpace with 3 nodes and 6 edges
 scheduler: fastest
 properties: Dict{Symbol,Any}(:Is =&gt; [0, 0, 1],:death_rate =&gt; 0.02,:infection_period =&gt; 30,:β_und =&gt; [0.7, 0.6, 0.5],:Ns =&gt; [5000, 2000, 1000],:migration_rates =&gt; [0.9852216748768474 0.009852216748768475 0.004926108374384237; 0.014677103718199611 0.9784735812133074 0.006849315068493152; 0.019267822736030827 0.017341040462427744 0.9633911368015414],:detection_time =&gt; 14,:reinfection_probability =&gt; 0.05,:β_det =&gt; [0.08, 0.06, 0.04],:C =&gt; 3…)</code></pre><p>Alright, let&#39;s plot the cities as a graph to get an idea how the model &quot;looks like&quot;, using the function <a href="../../api/#AgentsPlots.plotabm"><code>plotabm</code></a>.</p><pre><code class="language-julia">using AgentsPlots

plotabm(model)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip9900">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip9900)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip9901">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip9900)" d="
M482.992 1521.01 L1956.76 1521.01 L1956.76 47.2441 L482.992 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip9902">
    <rect x="482" y="47" width="1475" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1284.74,1310.47 1305.89,1275.77 1326.98,1241.07 1347.96,1206.37 1368.78,1171.64 1389.38,1136.91 1409.7,1102.15 1429.7,1067.36 1449.31,1032.55 1468.49,997.704 
  1487.17,962.819 1505.31,927.892 1522.84,892.92 1539.72,857.897 1555.89,822.819 1571.29,787.683 1585.93,752.488 1599.86,717.239 1613.13,681.939 1625.8,646.593 
  1637.92,611.206 1649.55,575.78 1660.74,540.321 1671.55,504.833 1682.03,469.319 1692.24,433.784 1702.23,398.233 1712.05,362.669 1721.77,327.097 1731.43,291.52 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1704.62,321.545 1731.43,291.52 1739.37,330.979 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1731.43,291.52 1721.77,327.097 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1284.74,1310.47 1259.5,1279.52 1234.31,1248.55 1209.23,1217.55 1184.29,1186.49 1159.55,1155.37 1135.07,1124.17 1110.88,1092.86 1087.05,1061.43 1063.62,1029.86 
  1040.64,998.147 1018.17,966.259 996.249,934.185 974.932,901.906 954.268,869.406 934.307,836.668 915.047,803.693 896.441,770.496 878.438,737.095 860.989,703.507 
  844.042,669.749 827.549,635.838 811.457,601.791 795.717,567.624 780.28,533.356 765.093,499.002 750.108,464.58 735.273,430.107 720.539,395.6 705.856,361.076 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  703.382,401.25 705.856,361.076 736.51,387.16 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  705.856,361.076 720.539,395.6 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1746.22,257.782 1724.8,293.097 1703.45,328.399 1682.22,363.674 1661.17,398.908 1640.38,434.088 1619.9,469.199 1599.8,504.23 1580.13,539.165 1560.96,573.992 
  1542.36,608.697 1524.38,643.266 1507.09,677.686 1490.55,711.943 1474.82,746.024 1459.96,779.915 1445.97,813.617 1432.8,847.142 1420.38,880.505 1408.64,913.718 
  1397.53,946.795 1386.99,979.751 1376.94,1012.6 1367.33,1045.35 1358.1,1078.02 1349.17,1110.62 1340.5,1143.17 1332.02,1175.68 1323.66,1208.16 1315.36,1240.63 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1341.71,1210.2 1315.36,1240.63 1306.84,1201.29 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1315.36,1240.63 1323.66,1208.16 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1746.22,257.782 1709.94,266.098 1673.67,274.362 1637.42,282.52 1601.19,290.521 1564.98,298.312 1528.82,305.84 1492.7,313.053 1456.64,319.897 1420.63,326.322 
  1384.69,332.273 1348.83,337.699 1313.05,342.547 1277.36,346.764 1241.77,350.298 1206.29,353.099 1170.91,355.166 1135.62,356.55 1100.43,357.303 1065.32,357.478 
  1030.29,357.128 995.325,356.305 960.42,355.061 925.568,353.449 890.761,351.522 855.992,349.333 821.253,346.933 786.536,344.375 751.835,341.713 717.141,338.998 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  751.627,359.752 717.141,338.998 754.436,323.861 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  717.141,338.998 751.835,341.713 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  693.53,340.861 719.239,372.583 744.885,404.3 770.403,436.007 795.73,467.698 820.802,499.37 845.555,531.015 869.926,562.631 893.85,594.211 917.264,625.75 
  940.105,657.244 962.307,688.687 983.809,720.074 1004.55,751.4 1024.45,782.66 1043.47,813.85 1061.6,844.969 1078.9,876.021 1095.43,907.013 1111.26,937.949 
  1126.46,968.834 1141.08,999.674 1155.19,1030.47 1168.85,1061.24 1182.14,1091.97 1195.1,1122.68 1207.81,1153.36 1220.33,1184.04 1232.71,1214.7 1245.04,1245.36 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1248.31,1205.24 1245.04,1245.36 1214.91,1218.67 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1245.04,1245.36 1232.71,1214.7 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  693.53,340.861 730.031,332.527 766.519,324.246 802.979,316.072 839.397,308.056 875.758,300.253 912.05,292.714 948.258,285.495 984.368,278.646 1020.37,272.223 
  1056.24,266.276 1091.97,260.861 1127.55,256.029 1162.96,251.833 1198.19,248.328 1233.22,245.563 1268.06,243.539 1302.72,242.204 1337.21,241.506 1371.55,241.392 
  1405.74,241.808 1439.81,242.702 1473.77,244.021 1507.63,245.711 1541.41,247.719 1575.11,249.992 1608.76,252.478 1642.37,255.123 1675.95,257.874 1709.52,260.678 
  
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1675.14,239.744 1709.52,260.678 1672.14,275.619 
  "/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1709.52,260.678 1675.95,257.874 
  "/>
<path clip-path="url(#clip9902)" d="
M1361.06 1310.47 L1360.82 1304.41 L1360.1 1298.38 L1358.9 1292.43 L1357.23 1286.6 L1355.11 1280.91 L1352.54 1275.42 L1349.54 1270.14 L1346.13 1265.12 L1342.33 1260.39 
  L1338.17 1255.97 L1333.67 1251.9 L1328.86 1248.2 L1323.78 1244.89 L1318.44 1241.99 L1312.9 1239.53 L1307.17 1237.52 L1301.3 1235.97 L1295.33 1234.89 L1289.29 1234.29 
  L1283.23 1234.17 L1277.17 1234.53 L1271.16 1235.37 L1265.23 1236.69 L1259.43 1238.47 L1253.79 1240.71 L1248.35 1243.39 L1243.13 1246.49 L1238.18 1250 L1233.53 1253.89 
  L1229.19 1258.14 L1225.21 1262.72 L1221.6 1267.6 L1218.4 1272.75 L1215.61 1278.14 L1213.26 1283.73 L1211.36 1289.5 L1209.93 1295.39 L1208.97 1301.39 L1208.48 1307.44 
  L1208.48 1313.5 L1208.97 1319.55 L1209.93 1325.55 L1211.36 1331.44 L1213.26 1337.21 L1215.61 1342.8 L1218.4 1348.19 L1221.6 1353.34 L1225.21 1358.22 L1229.19 1362.8 
  L1233.53 1367.05 L1238.18 1370.94 L1243.13 1374.45 L1248.35 1377.55 L1253.79 1380.23 L1259.43 1382.47 L1265.23 1384.25 L1271.16 1385.57 L1277.17 1386.41 L1283.23 1386.78 
  L1289.29 1386.65 L1295.33 1386.05 L1301.3 1384.97 L1307.17 1383.42 L1312.9 1381.41 L1318.44 1378.95 L1323.78 1376.05 L1328.86 1372.75 L1333.67 1369.04 L1338.17 1364.97 
  L1342.33 1360.55 L1346.13 1355.82 L1349.54 1350.8 L1352.54 1345.52 L1355.11 1340.03 L1357.23 1334.34 L1358.9 1328.51 L1360.1 1322.56 L1360.82 1316.53 L1361.06 1310.47 
  L1361.06 1310.47  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  1361.06,1310.47 1360.82,1304.41 1360.1,1298.38 1358.9,1292.43 1357.23,1286.6 1355.11,1280.91 1352.54,1275.42 1349.54,1270.14 1346.13,1265.12 1342.33,1260.39 
  1338.17,1255.97 1333.67,1251.9 1328.86,1248.2 1323.78,1244.89 1318.44,1241.99 1312.9,1239.53 1307.17,1237.52 1301.3,1235.97 1295.33,1234.89 1289.29,1234.29 
  1283.23,1234.17 1277.17,1234.53 1271.16,1235.37 1265.23,1236.69 1259.43,1238.47 1253.79,1240.71 1248.35,1243.39 1243.13,1246.49 1238.18,1250 1233.53,1253.89 
  1229.19,1258.14 1225.21,1262.72 1221.6,1267.6 1218.4,1272.75 1215.61,1278.14 1213.26,1283.73 1211.36,1289.5 1209.93,1295.39 1208.97,1301.39 1208.48,1307.44 
  1208.48,1313.5 1208.97,1319.55 1209.93,1325.55 1211.36,1331.44 1213.26,1337.21 1215.61,1342.8 1218.4,1348.19 1221.6,1353.34 1225.21,1358.22 1229.19,1362.8 
  1233.53,1367.05 1238.18,1370.94 1243.13,1374.45 1248.35,1377.55 1253.79,1380.23 1259.43,1382.47 1265.23,1384.25 1271.16,1385.57 1277.17,1386.41 1283.23,1386.78 
  1289.29,1386.65 1295.33,1386.05 1301.3,1384.97 1307.17,1383.42 1312.9,1381.41 1318.44,1378.95 1323.78,1376.05 1328.86,1372.75 1333.67,1369.04 1338.17,1364.97 
  1342.33,1360.55 1346.13,1355.82 1349.54,1350.8 1352.54,1345.52 1355.11,1340.03 1357.23,1334.34 1358.9,1328.51 1360.1,1322.56 1360.82,1316.53 1361.06,1310.47 
  
  "/>
<path clip-path="url(#clip9902)" d="
M1783.06 257.782 L1782.95 254.855 L1782.6 251.946 L1782.02 249.074 L1781.21 246.257 L1780.19 243.513 L1778.95 240.859 L1777.5 238.313 L1775.85 235.889 L1774.02 233.604 
  L1772.01 231.471 L1769.84 229.505 L1767.52 227.718 L1765.06 226.121 L1762.49 224.724 L1759.81 223.536 L1757.04 222.564 L1754.21 221.815 L1751.33 221.294 L1748.41 221.003 
  L1745.49 220.945 L1742.56 221.12 L1739.66 221.526 L1736.8 222.162 L1734 223.023 L1731.28 224.103 L1728.65 225.397 L1726.13 226.895 L1723.74 228.589 L1721.49 230.467 
  L1719.4 232.518 L1717.48 234.728 L1715.74 237.084 L1714.19 239.572 L1712.84 242.174 L1711.71 244.875 L1710.79 247.657 L1710.1 250.504 L1709.64 253.397 L1709.4 256.317 
  L1709.4 259.247 L1709.64 262.167 L1710.1 265.059 L1710.79 267.906 L1711.71 270.689 L1712.84 273.39 L1714.19 275.992 L1715.74 278.479 L1717.48 280.835 L1719.4 283.046 
  L1721.49 285.097 L1723.74 286.975 L1726.13 288.669 L1728.65 290.167 L1731.28 291.46 L1734 292.541 L1736.8 293.402 L1739.66 294.038 L1742.56 294.444 L1745.49 294.619 
  L1748.41 294.56 L1751.33 294.27 L1754.21 293.748 L1757.04 292.999 L1759.81 292.028 L1762.49 290.84 L1765.06 289.443 L1767.52 287.846 L1769.84 286.058 L1772.01 284.092 
  L1774.02 281.96 L1775.85 279.675 L1777.5 277.251 L1778.95 274.704 L1780.19 272.05 L1781.21 269.306 L1782.02 266.49 L1782.6 263.618 L1782.95 260.709 L1783.06 257.782 
  L1783.06 257.782  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  1783.06,257.782 1782.95,254.855 1782.6,251.946 1782.02,249.074 1781.21,246.257 1780.19,243.513 1778.95,240.859 1777.5,238.313 1775.85,235.889 1774.02,233.604 
  1772.01,231.471 1769.84,229.505 1767.52,227.718 1765.06,226.121 1762.49,224.724 1759.81,223.536 1757.04,222.564 1754.21,221.815 1751.33,221.294 1748.41,221.003 
  1745.49,220.945 1742.56,221.12 1739.66,221.526 1736.8,222.162 1734,223.023 1731.28,224.103 1728.65,225.397 1726.13,226.895 1723.74,228.589 1721.49,230.467 
  1719.4,232.518 1717.48,234.728 1715.74,237.084 1714.19,239.572 1712.84,242.174 1711.71,244.875 1710.79,247.657 1710.1,250.504 1709.64,253.397 1709.4,256.317 
  1709.4,259.247 1709.64,262.167 1710.1,265.059 1710.79,267.906 1711.71,270.689 1712.84,273.39 1714.19,275.992 1715.74,278.479 1717.48,280.835 1719.4,283.046 
  1721.49,285.097 1723.74,286.975 1726.13,288.669 1728.65,290.167 1731.28,291.46 1734,292.541 1736.8,293.402 1739.66,294.038 1742.56,294.444 1745.49,294.619 
  1748.41,294.56 1751.33,294.27 1754.21,293.748 1757.04,292.999 1759.81,292.028 1762.49,290.84 1765.06,289.443 1767.52,287.846 1769.84,286.058 1772.01,284.092 
  1774.02,281.96 1775.85,279.675 1777.5,277.251 1778.95,274.704 1780.19,272.05 1781.21,269.306 1782.02,266.49 1782.6,263.618 1782.95,260.709 1783.06,257.782 
  
  "/>
<path clip-path="url(#clip9902)" d="
M717.215 340.861 L717.14 338.979 L716.916 337.109 L716.544 335.263 L716.027 333.452 L715.367 331.688 L714.569 329.983 L713.638 328.345 L712.58 326.787 L711.402 325.318 
  L710.111 323.947 L708.714 322.683 L707.222 321.535 L705.643 320.508 L703.988 319.61 L702.267 318.846 L700.49 318.221 L698.669 317.74 L696.816 317.405 L694.942 317.218 
  L693.059 317.18 L691.179 317.293 L689.314 317.554 L687.475 317.963 L685.675 318.516 L683.925 319.211 L682.235 320.042 L680.617 321.005 L679.08 322.094 L677.635 323.302 
  L676.29 324.62 L675.054 326.041 L673.935 327.556 L672.94 329.155 L672.075 330.828 L671.345 332.564 L670.756 334.353 L670.311 336.183 L670.013 338.042 L669.863 339.92 
  L669.863 341.803 L670.013 343.68 L670.311 345.54 L670.756 347.37 L671.345 349.158 L672.075 350.895 L672.94 352.568 L673.935 354.167 L675.054 355.681 L676.29 357.102 
  L677.635 358.421 L679.08 359.628 L680.617 360.717 L682.235 361.68 L683.925 362.512 L685.675 363.206 L687.475 363.76 L689.314 364.168 L691.179 364.43 L693.059 364.542 
  L694.942 364.505 L696.816 364.318 L698.669 363.982 L700.49 363.501 L702.267 362.876 L703.988 362.113 L705.643 361.215 L707.222 360.188 L708.714 359.039 L710.111 357.775 
  L711.402 356.404 L712.58 354.935 L713.638 353.377 L714.569 351.74 L715.367 350.034 L716.027 348.27 L716.544 346.459 L716.916 344.613 L717.14 342.743 L717.215 340.861 
  L717.215 340.861  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip9902)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  717.215,340.861 717.14,338.979 716.916,337.109 716.544,335.263 716.027,333.452 715.367,331.688 714.569,329.983 713.638,328.345 712.58,326.787 711.402,325.318 
  710.111,323.947 708.714,322.683 707.222,321.535 705.643,320.508 703.988,319.61 702.267,318.846 700.49,318.221 698.669,317.74 696.816,317.405 694.942,317.218 
  693.059,317.18 691.179,317.293 689.314,317.554 687.475,317.963 685.675,318.516 683.925,319.211 682.235,320.042 680.617,321.005 679.08,322.094 677.635,323.302 
  676.29,324.62 675.054,326.041 673.935,327.556 672.94,329.155 672.075,330.828 671.345,332.564 670.756,334.353 670.311,336.183 670.013,338.042 669.863,339.92 
  669.863,341.803 670.013,343.68 670.311,345.54 670.756,347.37 671.345,349.158 672.075,350.895 672.94,352.568 673.935,354.167 675.054,355.681 676.29,357.102 
  677.635,358.421 679.08,359.628 680.617,360.717 682.235,361.68 683.925,362.512 685.675,363.206 687.475,363.76 689.314,364.168 691.179,364.43 693.059,364.542 
  694.942,364.505 696.816,364.318 698.669,363.982 700.49,363.501 702.267,362.876 703.988,362.113 705.643,361.215 707.222,360.188 708.714,359.039 710.111,357.775 
  711.402,356.404 712.58,354.935 713.638,353.377 714.569,351.74 715.367,350.034 716.027,348.27 716.544,346.459 716.916,344.613 717.14,342.743 717.215,340.861 
  
  "/>
<circle clip-path="url(#clip9902)" style="fill:#000000; stroke:none; fill-opacity:0" cx="1284.74" cy="1310.47" r="2"/>
<circle clip-path="url(#clip9902)" style="fill:#000000; stroke:none; fill-opacity:0" cx="1746.22" cy="257.782" r="2"/>
<circle clip-path="url(#clip9902)" style="fill:#000000; stroke:none; fill-opacity:0" cx="693.53" cy="340.861" r="2"/>
</svg>
<p>The node size is proportional to the relative population of each city. In principle we could adjust the edge widths to be proportional with the migration rates, by doing:</p><pre><code class="language-julia">g = model.space.graph
edgewidthsdict = Dict()
for node in 1:nv(g)
	nbs = neighbors(g, node)
	for nb in nbs
		edgewidthsdict[(node, nb)] = params[:migration_rates][node, nb]
	end
end

edgewidthsf(s, d, w) = edgewidthsdict[(s, d)] * 100

plotabm(model; edgewidth = edgewidthsf)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip0500">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip0500)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0501">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip0500)" d="
M482.992 1521.01 L1956.76 1521.01 L1956.76 47.2441 L482.992 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip0502">
    <rect x="482" y="47" width="1475" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  1746.22,1059.46 1716.28,1035.04 1686.38,1010.6 1656.59,986.111 1626.95,961.559 1597.51,936.92 1568.32,912.172 1539.44,887.293 1510.9,862.262 1482.77,837.055 
  1455.09,811.652 1427.92,786.031 1401.3,760.17 1375.28,734.047 1349.92,707.641 1325.26,680.929 1301.31,653.913 1278,626.614 1255.31,599.052 1233.16,571.251 
  1211.52,543.231 1190.34,515.015 1169.55,486.624 1149.12,458.081 1128.99,429.406 1109.11,400.623 1089.43,371.752 1069.91,342.815 1050.48,313.835 1031.11,284.834 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  1036.14,324.767 1031.11,284.834 1066.07,304.769 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  1031.11,284.834 1050.48,313.835 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  1746.22,1059.46 1710.78,1073.5 1675.35,1087.48 1639.91,1101.36 1604.48,1115.08 1569.03,1128.59 1533.59,1141.83 1498.14,1154.75 1462.69,1167.3 1427.23,1179.43 
  1391.77,1191.08 1356.3,1202.2 1320.82,1212.73 1285.33,1222.63 1249.83,1231.84 1214.33,1240.3 1178.81,1248.03 1143.29,1255.06 1107.76,1261.46 1072.22,1267.27 
  1036.67,1272.56 1001.12,1277.36 965.563,1281.74 930.001,1285.75 894.435,1289.44 858.865,1292.87 823.292,1296.08 787.718,1299.14 752.142,1302.08 716.565,1304.98 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  753.907,1320 716.565,1304.98 750.987,1284.12 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  716.565,1304.98 752.142,1302.08 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  1006.13,257.782 1036.54,282.7 1066.88,307.626 1097.09,332.567 1127.11,357.531 1156.88,382.525 1186.33,407.557 1215.4,432.634 1244.02,457.764 1272.14,482.954 
  1299.68,508.213 1326.59,533.546 1352.8,558.963 1378.25,584.471 1402.87,610.076 1426.6,635.788 1449.45,661.604 1471.48,687.519 1492.74,713.524 1513.3,739.612 
  1533.23,765.776 1552.58,792.008 1571.43,818.3 1589.83,844.645 1607.85,871.035 1625.56,897.463 1643.01,923.922 1660.27,950.403 1677.4,976.899 1694.47,1003.4 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  1690.11,963.39 1694.47,1003.4 1659.84,982.882 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  1694.47,1003.4 1677.4,976.899 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  1006.13,257.782 1000.45,296.018 994.72,334.229 988.898,372.388 982.936,410.469 976.789,448.447 970.41,486.295 963.753,523.987 956.772,561.498 949.42,598.802 
  941.651,635.873 933.419,672.684 924.677,709.211 915.379,745.426 905.479,781.305 894.932,816.822 883.738,851.977 871.942,886.795 859.59,921.303 846.728,955.525 
  833.403,989.488 819.661,1023.22 805.548,1056.74 791.11,1090.08 776.395,1123.27 761.448,1156.32 746.316,1189.28 731.044,1222.15 715.68,1254.98 700.27,1287.77 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  731.871,1262.84 700.27,1287.77 699.288,1247.54 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  700.27,1287.77 715.68,1254.98 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  693.53,1310.47 729.841,1296.22 766.128,1282.04 802.367,1267.97 838.531,1254.07 874.598,1240.42 910.542,1227.06 946.34,1214.05 981.966,1201.46 1017.4,1189.34 
  1052.61,1177.75 1087.57,1166.75 1122.27,1156.4 1156.67,1146.77 1190.75,1137.9 1224.49,1129.85 1257.89,1122.63 1290.97,1116.18 1323.76,1110.43 1356.28,1105.34 
  1388.55,1100.84 1420.61,1096.86 1452.46,1093.37 1484.15,1090.28 1515.69,1087.55 1547.11,1085.12 1578.42,1082.92 1609.67,1080.9 1640.87,1078.99 1672.04,1077.15 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  1635.04,1061.31 1672.04,1077.15 1637.16,1097.24 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  1672.04,1077.15 1640.87,1078.99 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  693.53,1310.47 699.278,1272.02 705.07,1233.6 710.952,1195.24 716.966,1156.98 723.159,1118.85 729.575,1080.88 736.257,1043.1 743.251,1005.55 750.601,968.248 
  758.351,931.241 766.546,894.554 775.23,858.22 784.449,822.272 794.246,786.741 804.664,751.659 815.703,717.024 827.321,682.807 839.472,648.976 852.113,615.497 
  865.199,582.34 878.686,549.472 892.528,516.86 906.682,484.473 921.102,452.279 935.746,420.246 950.567,388.341 965.522,356.532 980.565,324.788 995.654,293.075 
  
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  963.933,317.85 995.654,293.075 996.441,333.317 
  "/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  995.654,293.075 980.565,324.788 
  "/>
<path clip-path="url(#clip0502)" d="
M1822.54 1059.46 L1822.3 1053.4 L1821.57 1047.37 L1820.38 1041.42 L1818.71 1035.59 L1816.58 1029.9 L1814.01 1024.41 L1811.01 1019.13 L1807.6 1014.11 L1803.81 1009.38 
  L1799.65 1004.96 L1795.15 1000.89 L1790.34 997.186 L1785.25 993.877 L1779.92 990.984 L1774.37 988.523 L1768.64 986.51 L1762.78 984.959 L1756.81 983.879 L1750.77 983.277 
  L1744.7 983.156 L1738.64 983.518 L1732.63 984.36 L1726.71 985.676 L1720.91 987.46 L1715.27 989.698 L1709.82 992.377 L1704.61 995.481 L1699.66 998.989 L1695 1002.88 
  L1690.67 1007.13 L1686.68 1011.71 L1683.08 1016.59 L1679.87 1021.74 L1677.08 1027.13 L1674.73 1032.73 L1672.84 1038.49 L1671.4 1044.39 L1670.44 1050.38 L1669.96 1056.43 
  L1669.96 1062.49 L1670.44 1068.54 L1671.4 1074.54 L1672.84 1080.43 L1674.73 1086.2 L1677.08 1091.79 L1679.87 1097.18 L1683.08 1102.33 L1686.68 1107.21 L1690.67 1111.79 
  L1695 1116.04 L1699.66 1119.93 L1704.61 1123.44 L1709.82 1126.54 L1715.27 1129.22 L1720.91 1131.46 L1726.71 1133.25 L1732.63 1134.56 L1738.64 1135.4 L1744.7 1135.77 
  L1750.77 1135.64 L1756.81 1135.04 L1762.78 1133.96 L1768.64 1132.41 L1774.37 1130.4 L1779.92 1127.94 L1785.25 1125.04 L1790.34 1121.74 L1795.15 1118.03 L1799.65 1113.96 
  L1803.81 1109.54 L1807.6 1104.81 L1811.01 1099.79 L1814.01 1094.51 L1816.58 1089.02 L1818.71 1083.33 L1820.38 1077.5 L1821.57 1071.55 L1822.3 1065.52 L1822.54 1059.46 
  L1822.54 1059.46  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  1822.54,1059.46 1822.3,1053.4 1821.57,1047.37 1820.38,1041.42 1818.71,1035.59 1816.58,1029.9 1814.01,1024.41 1811.01,1019.13 1807.6,1014.11 1803.81,1009.38 
  1799.65,1004.96 1795.15,1000.89 1790.34,997.186 1785.25,993.877 1779.92,990.984 1774.37,988.523 1768.64,986.51 1762.78,984.959 1756.81,983.879 1750.77,983.277 
  1744.7,983.156 1738.64,983.518 1732.63,984.36 1726.71,985.676 1720.91,987.46 1715.27,989.698 1709.82,992.377 1704.61,995.481 1699.66,998.989 1695,1002.88 
  1690.67,1007.13 1686.68,1011.71 1683.08,1016.59 1679.87,1021.74 1677.08,1027.13 1674.73,1032.73 1672.84,1038.49 1671.4,1044.39 1670.44,1050.38 1669.96,1056.43 
  1669.96,1062.49 1670.44,1068.54 1671.4,1074.54 1672.84,1080.43 1674.73,1086.2 1677.08,1091.79 1679.87,1097.18 1683.08,1102.33 1686.68,1107.21 1690.67,1111.79 
  1695,1116.04 1699.66,1119.93 1704.61,1123.44 1709.82,1126.54 1715.27,1129.22 1720.91,1131.46 1726.71,1133.25 1732.63,1134.56 1738.64,1135.4 1744.7,1135.77 
  1750.77,1135.64 1756.81,1135.04 1762.78,1133.96 1768.64,1132.41 1774.37,1130.4 1779.92,1127.94 1785.25,1125.04 1790.34,1121.74 1795.15,1118.03 1799.65,1113.96 
  1803.81,1109.54 1807.6,1104.81 1811.01,1099.79 1814.01,1094.51 1816.58,1089.02 1818.71,1083.33 1820.38,1077.5 1821.57,1071.55 1822.3,1065.52 1822.54,1059.46 
  
  "/>
<path clip-path="url(#clip0502)" d="
M1042.98 257.782 L1042.86 254.855 L1042.51 251.946 L1041.93 249.074 L1041.13 246.257 L1040.1 243.513 L1038.86 240.859 L1037.41 238.313 L1035.77 235.889 L1033.94 233.604 
  L1031.93 231.471 L1029.75 229.505 L1027.43 227.718 L1024.98 226.121 L1022.4 224.724 L1019.72 223.536 L1016.96 222.564 L1014.13 221.815 L1011.25 221.294 L1008.33 221.003 
  L1005.4 220.945 L1002.48 221.12 L999.576 221.526 L996.716 222.162 L993.916 223.023 L991.193 224.103 L988.564 225.397 L986.047 226.895 L983.657 228.589 L981.408 230.467 
  L979.316 232.518 L977.394 234.728 L975.653 237.084 L974.105 239.572 L972.759 242.174 L971.625 244.875 L970.708 247.657 L970.016 250.504 L969.552 253.397 L969.319 256.317 
  L969.319 259.247 L969.552 262.167 L970.016 265.059 L970.708 267.906 L971.625 270.689 L972.759 273.39 L974.105 275.992 L975.653 278.479 L977.394 280.835 L979.316 283.046 
  L981.408 285.097 L983.657 286.975 L986.047 288.669 L988.564 290.167 L991.193 291.46 L993.916 292.541 L996.716 293.402 L999.576 294.038 L1002.48 294.444 L1005.4 294.619 
  L1008.33 294.56 L1011.25 294.27 L1014.13 293.748 L1016.96 292.999 L1019.72 292.028 L1022.4 290.84 L1024.98 289.443 L1027.43 287.846 L1029.75 286.058 L1031.93 284.092 
  L1033.94 281.96 L1035.77 279.675 L1037.41 277.251 L1038.86 274.704 L1040.1 272.05 L1041.13 269.306 L1041.93 266.49 L1042.51 263.618 L1042.86 260.709 L1042.98 257.782 
  L1042.98 257.782  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  1042.98,257.782 1042.86,254.855 1042.51,251.946 1041.93,249.074 1041.13,246.257 1040.1,243.513 1038.86,240.859 1037.41,238.313 1035.77,235.889 1033.94,233.604 
  1031.93,231.471 1029.75,229.505 1027.43,227.718 1024.98,226.121 1022.4,224.724 1019.72,223.536 1016.96,222.564 1014.13,221.815 1011.25,221.294 1008.33,221.003 
  1005.4,220.945 1002.48,221.12 999.576,221.526 996.716,222.162 993.916,223.023 991.193,224.103 988.564,225.397 986.047,226.895 983.657,228.589 981.408,230.467 
  979.316,232.518 977.394,234.728 975.653,237.084 974.105,239.572 972.759,242.174 971.625,244.875 970.708,247.657 970.016,250.504 969.552,253.397 969.319,256.317 
  969.319,259.247 969.552,262.167 970.016,265.059 970.708,267.906 971.625,270.689 972.759,273.39 974.105,275.992 975.653,278.479 977.394,280.835 979.316,283.046 
  981.408,285.097 983.657,286.975 986.047,288.669 988.564,290.167 991.193,291.46 993.916,292.541 996.716,293.402 999.576,294.038 1002.48,294.444 1005.4,294.619 
  1008.33,294.56 1011.25,294.27 1014.13,293.748 1016.96,292.999 1019.72,292.028 1022.4,290.84 1024.98,289.443 1027.43,287.846 1029.75,286.058 1031.93,284.092 
  1033.94,281.96 1035.77,279.675 1037.41,277.251 1038.86,274.704 1040.1,272.05 1041.13,269.306 1041.93,266.49 1042.51,263.618 1042.86,260.709 1042.98,257.782 
  
  "/>
<path clip-path="url(#clip0502)" d="
M717.215 1310.47 L717.14 1308.59 L716.916 1306.72 L716.544 1304.87 L716.027 1303.06 L715.367 1301.3 L714.569 1299.59 L713.638 1297.95 L712.58 1296.4 L711.402 1294.93 
  L710.111 1293.56 L708.714 1292.29 L707.222 1291.14 L705.643 1290.12 L703.988 1289.22 L702.267 1288.45 L700.49 1287.83 L698.669 1287.35 L696.816 1287.01 L694.942 1286.83 
  L693.059 1286.79 L691.179 1286.9 L689.314 1287.16 L687.475 1287.57 L685.675 1288.12 L683.925 1288.82 L682.235 1289.65 L680.617 1290.61 L679.08 1291.7 L677.635 1292.91 
  L676.29 1294.23 L675.054 1295.65 L673.935 1297.16 L672.94 1298.76 L672.075 1300.44 L671.345 1302.17 L670.756 1303.96 L670.311 1305.79 L670.013 1307.65 L669.863 1309.53 
  L669.863 1311.41 L670.013 1313.29 L670.311 1315.15 L670.756 1316.98 L671.345 1318.77 L672.075 1320.5 L672.94 1322.18 L673.935 1323.78 L675.054 1325.29 L676.29 1326.71 
  L677.635 1328.03 L679.08 1329.24 L680.617 1330.33 L682.235 1331.29 L683.925 1332.12 L685.675 1332.82 L687.475 1333.37 L689.314 1333.78 L691.179 1334.04 L693.059 1334.15 
  L694.942 1334.11 L696.816 1333.93 L698.669 1333.59 L700.49 1333.11 L702.267 1332.49 L703.988 1331.72 L705.643 1330.82 L707.222 1329.8 L708.714 1328.65 L710.111 1327.38 
  L711.402 1326.01 L712.58 1324.54 L713.638 1322.99 L714.569 1321.35 L715.367 1319.64 L716.027 1317.88 L716.544 1316.07 L716.916 1314.22 L717.14 1312.35 L717.215 1310.47 
  L717.215 1310.47  Z
  " fill="#765db4" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip0502)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  717.215,1310.47 717.14,1308.59 716.916,1306.72 716.544,1304.87 716.027,1303.06 715.367,1301.3 714.569,1299.59 713.638,1297.95 712.58,1296.4 711.402,1294.93 
  710.111,1293.56 708.714,1292.29 707.222,1291.14 705.643,1290.12 703.988,1289.22 702.267,1288.45 700.49,1287.83 698.669,1287.35 696.816,1287.01 694.942,1286.83 
  693.059,1286.79 691.179,1286.9 689.314,1287.16 687.475,1287.57 685.675,1288.12 683.925,1288.82 682.235,1289.65 680.617,1290.61 679.08,1291.7 677.635,1292.91 
  676.29,1294.23 675.054,1295.65 673.935,1297.16 672.94,1298.76 672.075,1300.44 671.345,1302.17 670.756,1303.96 670.311,1305.79 670.013,1307.65 669.863,1309.53 
  669.863,1311.41 670.013,1313.29 670.311,1315.15 670.756,1316.98 671.345,1318.77 672.075,1320.5 672.94,1322.18 673.935,1323.78 675.054,1325.29 676.29,1326.71 
  677.635,1328.03 679.08,1329.24 680.617,1330.33 682.235,1331.29 683.925,1332.12 685.675,1332.82 687.475,1333.37 689.314,1333.78 691.179,1334.04 693.059,1334.15 
  694.942,1334.11 696.816,1333.93 698.669,1333.59 700.49,1333.11 702.267,1332.49 703.988,1331.72 705.643,1330.82 707.222,1329.8 708.714,1328.65 710.111,1327.38 
  711.402,1326.01 712.58,1324.54 713.638,1322.99 714.569,1321.35 715.367,1319.64 716.027,1317.88 716.544,1316.07 716.916,1314.22 717.14,1312.35 717.215,1310.47 
  
  "/>
<circle clip-path="url(#clip0502)" style="fill:#000000; stroke:none; fill-opacity:0" cx="1746.22" cy="1059.46" r="2"/>
<circle clip-path="url(#clip0502)" style="fill:#000000; stroke:none; fill-opacity:0" cx="1006.13" cy="257.782" r="2"/>
<circle clip-path="url(#clip0502)" style="fill:#000000; stroke:none; fill-opacity:0" cx="693.53" cy="1310.47" r="2"/>
</svg>
<p>In the following we will be colloring each node according to how large percentage of the population is infected</p><pre><code class="language-julia">infected_fraction(x) =  cgrad(:inferno)[count(a.status == :I for a in x)/length(x)]
plotabm(model, infected_fraction; edgewidth = edgewidthsf)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip1100">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1100)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1101">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1100)" d="
M482.992 1521.01 L1956.76 1521.01 L1956.76 47.2441 L482.992 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1102">
    <rect x="482" y="47" width="1475" height="1475"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  1746.22,1008.19 1710.81,1024.01 1675.41,1039.78 1640.01,1055.44 1604.62,1070.93 1569.25,1086.21 1533.89,1101.21 1498.55,1115.88 1463.23,1130.17 1427.93,1144.02 
  1392.67,1157.38 1357.43,1170.19 1322.23,1182.4 1287.07,1193.95 1251.95,1204.79 1216.87,1214.86 1181.83,1224.17 1146.84,1232.76 1111.88,1240.7 1076.95,1248.04 
  1042.06,1254.83 1007.2,1261.12 972.357,1266.98 937.539,1272.45 902.74,1277.6 867.956,1282.47 833.185,1287.12 798.423,1291.61 763.667,1295.99 728.915,1300.31 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  766.862,1313.73 728.915,1300.31 762.417,1278 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:3.94089; stroke-opacity:1; fill:none" points="
  728.915,1300.31 763.667,1295.99 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  1746.22,1008.19 1714.9,985.979 1683.63,963.737 1652.45,941.437 1621.4,919.048 1590.53,896.541 1559.88,873.886 1529.49,851.053 1499.41,828.014 1469.68,804.738 
  1440.35,781.196 1411.47,757.359 1383.06,733.196 1355.19,708.678 1327.89,683.777 1301.2,658.462 1275.13,632.735 1249.63,606.624 1224.66,580.157 1200.18,553.366 
  1176.14,526.279 1152.49,498.926 1129.2,471.336 1106.22,443.539 1083.5,415.566 1061,387.444 1038.68,359.204 1016.49,330.875 994.385,302.487 972.328,274.07 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  980.182,313.545 972.328,274.07 1008.62,291.471 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:1.97044; stroke-opacity:1; fill:none" points="
  972.328,274.07 994.385,302.487 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  693.53,1310.47 729.588,1294.46 765.624,1278.51 801.616,1262.68 837.543,1247.03 873.383,1231.62 909.114,1216.52 944.714,1201.77 980.162,1187.44 1015.44,1173.6 
  1050.51,1160.29 1085.37,1147.59 1119.99,1135.55 1154.35,1124.23 1188.42,1113.7 1222.19,1104 1255.66,1095.14 1288.84,1087.07 1321.76,1079.71 1354.44,1073.02 
  1386.91,1066.93 1419.17,1061.38 1451.27,1056.31 1483.21,1051.66 1515.02,1047.38 1546.72,1043.39 1578.33,1039.65 1609.88,1036.08 1641.38,1032.64 1672.87,1029.25 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  1635.15,1015.2 1672.87,1029.25 1639,1051 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:5.87084; stroke-opacity:1; fill:none" points="
  1672.87,1029.25 1641.38,1032.64 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  693.53,1310.47 707.925,1275.09 722.268,1239.7 736.504,1204.32 750.581,1168.93 764.445,1133.53 778.045,1098.13 791.326,1062.73 804.235,1027.31 816.72,991.884 
  828.727,956.448 840.203,921 851.095,885.539 861.351,850.063 870.916,814.573 879.741,779.065 887.825,743.541 895.219,708.002 901.976,672.448 908.149,636.882 
  913.792,601.303 918.956,565.714 923.697,530.115 928.065,494.508 932.115,458.894 935.9,423.273 939.473,387.648 942.886,352.02 946.193,316.389 949.447,280.757 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  928.248,314.971 949.447,280.757 964.098,318.245 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:2.73973; stroke-opacity:1; fill:none" points="
  949.447,280.757 946.193,316.389 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  955.157,257.782 987.126,280.615 1019.03,303.46 1050.81,326.329 1082.41,349.232 1113.75,372.183 1144.77,395.192 1175.42,418.272 1205.63,441.434 1235.33,464.69 
  1264.47,488.051 1292.98,511.53 1320.8,535.138 1347.87,558.887 1374.11,582.788 1399.48,606.853 1423.97,631.082 1447.65,655.464 1470.57,679.986 1492.79,704.638 
  1514.39,729.407 1535.43,754.281 1555.95,779.25 1576.04,804.3 1595.76,829.421 1615.15,854.601 1634.3,879.828 1653.26,905.09 1672.09,930.375 1690.86,955.672 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  1683.86,916.035 1690.86,955.672 1654.95,937.486 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:7.70713; stroke-opacity:1; fill:none" points="
  1690.86,955.672 1672.09,930.375 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  955.157,257.782 940.707,293.383 926.312,328.98 912.026,364.566 897.904,400.137 884.001,435.688 870.37,471.213 857.068,506.708 844.148,542.167 831.665,577.585 
  819.674,612.957 808.229,648.279 797.385,683.545 787.197,718.749 777.719,753.888 769.003,788.955 761.05,823.952 753.808,858.882 747.221,893.751 741.235,928.565 
  735.795,963.327 730.848,998.044 726.337,1032.72 722.209,1067.36 718.408,1101.97 714.881,1136.55 711.572,1171.12 708.427,1205.67 705.391,1240.2 702.41,1274.74 
  
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  723.44,1240.42 702.41,1274.74 687.573,1237.32 
  "/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:6.93642; stroke-opacity:1; fill:none" points="
  702.41,1274.74 705.391,1240.2 
  "/>
<path clip-path="url(#clip1102)" d="
M1822.54 1008.19 L1822.3 1002.13 L1821.57 996.101 L1820.38 990.152 L1818.71 984.317 L1816.58 978.634 L1814.01 973.137 L1811.01 967.861 L1807.6 962.841 L1803.81 958.107 
  L1799.65 953.69 L1795.15 949.617 L1790.34 945.915 L1785.25 942.607 L1779.92 939.713 L1774.37 937.252 L1768.64 935.24 L1762.78 933.688 L1756.81 932.608 L1750.77 932.006 
  L1744.7 931.885 L1738.64 932.247 L1732.63 933.089 L1726.71 934.406 L1720.91 936.189 L1715.27 938.427 L1709.82 941.107 L1704.61 944.21 L1699.66 947.719 L1695 951.609 
  L1690.67 955.857 L1686.68 960.436 L1683.08 965.317 L1679.87 970.469 L1677.08 975.86 L1674.73 981.454 L1672.84 987.218 L1671.4 993.115 L1670.44 999.107 L1669.96 1005.16 
  L1669.96 1011.22 L1670.44 1017.27 L1671.4 1023.27 L1672.84 1029.16 L1674.73 1034.93 L1677.08 1040.52 L1679.87 1045.91 L1683.08 1051.06 L1686.68 1055.94 L1690.67 1060.52 
  L1695 1064.77 L1699.66 1068.66 L1704.61 1072.17 L1709.82 1075.27 L1715.27 1077.95 L1720.91 1080.19 L1726.71 1081.97 L1732.63 1083.29 L1738.64 1084.13 L1744.7 1084.49 
  L1750.77 1084.37 L1756.81 1083.77 L1762.78 1082.69 L1768.64 1081.14 L1774.37 1079.13 L1779.92 1076.67 L1785.25 1073.77 L1790.34 1070.46 L1795.15 1066.76 L1799.65 1062.69 
  L1803.81 1058.27 L1807.6 1053.54 L1811.01 1048.52 L1814.01 1043.24 L1816.58 1037.75 L1818.71 1032.06 L1820.38 1026.23 L1821.57 1020.28 L1822.3 1014.25 L1822.54 1008.19 
  L1822.54 1008.19  Z
  " fill="#000003" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  1822.54,1008.19 1822.3,1002.13 1821.57,996.101 1820.38,990.152 1818.71,984.317 1816.58,978.634 1814.01,973.137 1811.01,967.861 1807.6,962.841 1803.81,958.107 
  1799.65,953.69 1795.15,949.617 1790.34,945.915 1785.25,942.607 1779.92,939.713 1774.37,937.252 1768.64,935.24 1762.78,933.688 1756.81,932.608 1750.77,932.006 
  1744.7,931.885 1738.64,932.247 1732.63,933.089 1726.71,934.406 1720.91,936.189 1715.27,938.427 1709.82,941.107 1704.61,944.21 1699.66,947.719 1695,951.609 
  1690.67,955.857 1686.68,960.436 1683.08,965.317 1679.87,970.469 1677.08,975.86 1674.73,981.454 1672.84,987.218 1671.4,993.115 1670.44,999.107 1669.96,1005.16 
  1669.96,1011.22 1670.44,1017.27 1671.4,1023.27 1672.84,1029.16 1674.73,1034.93 1677.08,1040.52 1679.87,1045.91 1683.08,1051.06 1686.68,1055.94 1690.67,1060.52 
  1695,1064.77 1699.66,1068.66 1704.61,1072.17 1709.82,1075.27 1715.27,1077.95 1720.91,1080.19 1726.71,1081.97 1732.63,1083.29 1738.64,1084.13 1744.7,1084.49 
  1750.77,1084.37 1756.81,1083.77 1762.78,1082.69 1768.64,1081.14 1774.37,1079.13 1779.92,1076.67 1785.25,1073.77 1790.34,1070.46 1795.15,1066.76 1799.65,1062.69 
  1803.81,1058.27 1807.6,1053.54 1811.01,1048.52 1814.01,1043.24 1816.58,1037.75 1818.71,1032.06 1820.38,1026.23 1821.57,1020.28 1822.3,1014.25 1822.54,1008.19 
  
  "/>
<path clip-path="url(#clip1102)" d="
M730.374 1310.47 L730.257 1307.54 L729.909 1304.63 L729.33 1301.76 L728.525 1298.95 L727.499 1296.2 L726.258 1293.55 L724.81 1291 L723.164 1288.58 L721.331 1286.29 
  L719.322 1284.16 L717.15 1282.19 L714.829 1280.41 L712.373 1278.81 L709.798 1277.41 L707.12 1276.22 L704.356 1275.25 L701.524 1274.5 L698.641 1273.98 L695.726 1273.69 
  L692.797 1273.63 L689.873 1273.81 L686.972 1274.21 L684.112 1274.85 L681.312 1275.71 L678.589 1276.79 L675.96 1278.09 L673.443 1279.58 L671.052 1281.28 L668.804 1283.16 
  L666.712 1285.21 L664.789 1287.42 L663.049 1289.77 L661.5 1292.26 L660.155 1294.86 L659.02 1297.56 L658.104 1300.35 L657.412 1303.19 L656.948 1306.09 L656.715 1309.01 
  L656.715 1311.93 L656.948 1314.86 L657.412 1317.75 L658.104 1320.59 L659.02 1323.38 L660.155 1326.08 L661.5 1328.68 L663.049 1331.17 L664.789 1333.52 L666.712 1335.73 
  L668.804 1337.79 L671.052 1339.66 L673.443 1341.36 L675.96 1342.86 L678.589 1344.15 L681.312 1345.23 L684.112 1346.09 L686.972 1346.73 L689.873 1347.13 L692.797 1347.31 
  L695.726 1347.25 L698.641 1346.96 L701.524 1346.44 L704.356 1345.69 L707.12 1344.72 L709.798 1343.53 L712.373 1342.13 L714.829 1340.53 L717.15 1338.75 L719.322 1336.78 
  L721.331 1334.65 L723.164 1332.36 L724.81 1329.94 L726.258 1327.39 L727.499 1324.74 L728.525 1321.99 L729.33 1319.18 L729.909 1316.31 L730.257 1313.4 L730.374 1310.47 
  L730.374 1310.47  Z
  " fill="#000003" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  730.374,1310.47 730.257,1307.54 729.909,1304.63 729.33,1301.76 728.525,1298.95 727.499,1296.2 726.258,1293.55 724.81,1291 723.164,1288.58 721.331,1286.29 
  719.322,1284.16 717.15,1282.19 714.829,1280.41 712.373,1278.81 709.798,1277.41 707.12,1276.22 704.356,1275.25 701.524,1274.5 698.641,1273.98 695.726,1273.69 
  692.797,1273.63 689.873,1273.81 686.972,1274.21 684.112,1274.85 681.312,1275.71 678.589,1276.79 675.96,1278.09 673.443,1279.58 671.052,1281.28 668.804,1283.16 
  666.712,1285.21 664.789,1287.42 663.049,1289.77 661.5,1292.26 660.155,1294.86 659.02,1297.56 658.104,1300.35 657.412,1303.19 656.948,1306.09 656.715,1309.01 
  656.715,1311.93 656.948,1314.86 657.412,1317.75 658.104,1320.59 659.02,1323.38 660.155,1326.08 661.5,1328.68 663.049,1331.17 664.789,1333.52 666.712,1335.73 
  668.804,1337.79 671.052,1339.66 673.443,1341.36 675.96,1342.86 678.589,1344.15 681.312,1345.23 684.112,1346.09 686.972,1346.73 689.873,1347.13 692.797,1347.31 
  695.726,1347.25 698.641,1346.96 701.524,1346.44 704.356,1345.69 707.12,1344.72 709.798,1343.53 712.373,1342.13 714.829,1340.53 717.15,1338.75 719.322,1336.78 
  721.331,1334.65 723.164,1332.36 724.81,1329.94 726.258,1327.39 727.499,1324.74 728.525,1321.99 729.33,1319.18 729.909,1316.31 730.257,1313.4 730.374,1310.47 
  
  "/>
<path clip-path="url(#clip1102)" d="
M978.843 257.782 L978.768 255.9 L978.544 254.03 L978.172 252.184 L977.654 250.373 L976.994 248.609 L976.197 246.903 L975.266 245.266 L974.208 243.708 L973.029 242.239 
  L971.738 240.868 L970.342 239.604 L968.85 238.455 L967.271 237.428 L965.615 236.53 L963.894 235.767 L962.117 235.142 L960.296 234.661 L958.443 234.325 L956.569 234.138 
  L954.686 234.101 L952.806 234.213 L950.941 234.475 L949.103 234.883 L947.303 235.437 L945.552 236.131 L943.862 236.963 L942.244 237.926 L940.707 239.015 L939.262 240.222 
  L937.917 241.54 L936.681 242.962 L935.562 244.476 L934.567 246.075 L933.702 247.748 L932.973 249.484 L932.383 251.273 L931.938 253.103 L931.64 254.963 L931.49 256.84 
  L931.49 258.723 L931.64 260.601 L931.938 262.46 L932.383 264.29 L932.973 266.079 L933.702 267.815 L934.567 269.488 L935.562 271.087 L936.681 272.602 L937.917 274.023 
  L939.262 275.341 L940.707 276.549 L942.244 277.638 L943.862 278.601 L945.552 279.432 L947.303 280.127 L949.103 280.68 L950.941 281.089 L952.806 281.35 L954.686 281.463 
  L956.569 281.425 L958.443 281.238 L960.296 280.903 L962.117 280.422 L963.894 279.797 L965.615 279.033 L967.271 278.135 L968.85 277.108 L970.342 275.96 L971.738 274.696 
  L973.029 273.325 L974.208 271.856 L975.266 270.298 L976.197 268.66 L976.994 266.954 L977.654 265.191 L978.172 263.38 L978.544 261.534 L978.768 259.664 L978.843 257.782 
  L978.843 257.782  Z
  " fill="#000004" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip1102)" style="stroke:#000000; stroke-width:0; stroke-opacity:0; fill:none" points="
  978.843,257.782 978.768,255.9 978.544,254.03 978.172,252.184 977.654,250.373 976.994,248.609 976.197,246.903 975.266,245.266 974.208,243.708 973.029,242.239 
  971.738,240.868 970.342,239.604 968.85,238.455 967.271,237.428 965.615,236.53 963.894,235.767 962.117,235.142 960.296,234.661 958.443,234.325 956.569,234.138 
  954.686,234.101 952.806,234.213 950.941,234.475 949.103,234.883 947.303,235.437 945.552,236.131 943.862,236.963 942.244,237.926 940.707,239.015 939.262,240.222 
  937.917,241.54 936.681,242.962 935.562,244.476 934.567,246.075 933.702,247.748 932.973,249.484 932.383,251.273 931.938,253.103 931.64,254.963 931.49,256.84 
  931.49,258.723 931.64,260.601 931.938,262.46 932.383,264.29 932.973,266.079 933.702,267.815 934.567,269.488 935.562,271.087 936.681,272.602 937.917,274.023 
  939.262,275.341 940.707,276.549 942.244,277.638 943.862,278.601 945.552,279.432 947.303,280.127 949.103,280.68 950.941,281.089 952.806,281.35 954.686,281.463 
  956.569,281.425 958.443,281.238 960.296,280.903 962.117,280.422 963.894,279.797 965.615,279.033 967.271,278.135 968.85,277.108 970.342,275.96 971.738,274.696 
  973.029,273.325 974.208,271.856 975.266,270.298 976.197,268.66 976.994,266.954 977.654,265.191 978.172,263.38 978.544,261.534 978.768,259.664 978.843,257.782 
  
  "/>
<circle clip-path="url(#clip1102)" style="fill:#000000; stroke:none; fill-opacity:0" cx="1746.22" cy="1008.19" r="2"/>
<circle clip-path="url(#clip1102)" style="fill:#000000; stroke:none; fill-opacity:0" cx="693.53" cy="1310.47" r="2"/>
<circle clip-path="url(#clip1102)" style="fill:#000000; stroke:none; fill-opacity:0" cx="955.157" cy="257.782" r="2"/>
</svg>
<p>Here this shows all nodes as black, since we haven&#39;t run the model yet. Let&#39;s change that!</p><h2 id="SIR-Stepping-functions-1"><a class="docs-heading-anchor" href="#SIR-Stepping-functions-1">SIR Stepping functions</a><a class="docs-heading-anchor-permalink" href="#SIR-Stepping-functions-1" title="Permalink"></a></h2><p>Now we define the functions for modelling the virus spread in time</p><pre><code class="language-julia">function agent_step!(agent, model)
    migrate!(agent, model)
    transmit!(agent, model)
    update!(agent, model)
    recover_or_die!(agent, model)
end

function migrate!(agent, model)
    nodeid = agent.pos
    d = DiscreteNonParametric(1:model.properties[:C], model.properties[:migration_rates][nodeid, :])
    m = rand(d)
    if m ≠ nodeid
        move_agent!(agent, m, model)
    end
end

function transmit!(agent, model)
    agent.status == :S &amp;&amp; return
    prop = model.properties
    rate = if agent.days_infected &lt; prop[:detection_time]
            prop[:β_und][agent.pos]
        else
            prop[:β_det][agent.pos]
    end

    d = Poisson(rate)
    n = rand(d)
    n == 0 &amp;&amp; return

    for contactID in get_node_contents(agent, model)
        contact = id2agent(contactID, model)
        if contact.status == :S || (contact.status == :R &amp;&amp; rand() ≤ prop[:reinfection_probability])
            contact.status = :I
            n -= 1
            n == 0 &amp;&amp; return
        end
    end
end

update!(agent, model) = agent.status == :I &amp;&amp; (agent.days_infected += 1)

function recover_or_die!(agent, model)
    if agent.days_infected ≥ model.properties[:infection_period]
        if rand() ≤ model.properties[:death_rate]
            kill_agent!(agent, model)
        else
            agent.status = :R
            agent.days_infected = 0
        end
    end
end</code></pre><pre><code class="language-none">recover_or_die! (generic function with 1 method)</code></pre><h2 id="Example-animation-1"><a class="docs-heading-anchor" href="#Example-animation-1">Example animation</a><a class="docs-heading-anchor-permalink" href="#Example-animation-1" title="Permalink"></a></h2><pre><code class="language-julia">model = model_initiation(;params...)

anim = @animate for i ∈ 1:30
	step!(model, agent_step!, 1)
	p1 = plotabm(model, infected_fraction; method = :circular, edgewidth = edgewidthsf)
	title!(p1, &quot;Step $(i)&quot;)
end

gif(anim, &quot;covid_evolution.gif&quot;, fps = 5);

model</code></pre><pre><code class="language-none">AgentBasedModel with 8000 agents of type PoorSoul
 space: GraphSpace with 3 nodes and 6 edges
 scheduler: fastest
 properties: Dict{Symbol,Any}(:Is =&gt; [0, 0, 1],:death_rate =&gt; 0.02,:infection_period =&gt; 30,:β_und =&gt; [0.7, 0.6, 0.5],:Ns =&gt; [5000, 2000, 1000],:migration_rates =&gt; [0.9852216748768472 0.009852216748768473 0.0049261083743842365; 0.014677103718199608 0.9784735812133072 0.00684931506849315; 0.019267822736030827 0.017341040462427744 0.9633911368015414],:detection_time =&gt; 14,:reinfection_probability =&gt; 0.05,:β_det =&gt; [0.08, 0.06, 0.04],:C =&gt; 3…)</code></pre><p><img src="../covid_evolution.gif" alt/></p><p><em>(important notice: always provide an appropriate <code>method</code> keyword when you want to animate ABMs)</em></p><h2 id="Exponential-growth-1"><a class="docs-heading-anchor" href="#Exponential-growth-1">Exponential growth</a><a class="docs-heading-anchor-permalink" href="#Exponential-growth-1" title="Permalink"></a></h2><p>We now run the model and collect data. We define two useful functions for data collection:</p><pre><code class="language-julia">infected(x) = count(i == :I for i in x)
recovered(x) = count(i == :R for i in x)</code></pre><pre><code class="language-none">recovered (generic function with 1 method)</code></pre><p>and then collect data</p><pre><code class="language-julia">model = model_initiation(;params...)

data_to_collect = Dict(:status =&gt; [infected, recovered, length])
data = step!(model, agent_step!, 50, data_to_collect)
data[1:10, :]</code></pre><table class="data-frame"><thead><tr><th></th><th>infected(status)</th><th>length(status)</th><th>recovered(status)</th><th>step</th></tr><tr><th></th><th>Int64</th><th>Int64</th><th>Int64</th><th>Int64</th></tr></thead><tbody><p>10 rows × 4 columns</p><tr><th>1</th><td>1</td><td>8000</td><td>0</td><td>0</td></tr><tr><th>2</th><td>1</td><td>8000</td><td>0</td><td>1</td></tr><tr><th>3</th><td>1</td><td>8000</td><td>0</td><td>2</td></tr><tr><th>4</th><td>6</td><td>8000</td><td>0</td><td>3</td></tr><tr><th>5</th><td>7</td><td>8000</td><td>0</td><td>4</td></tr><tr><th>6</th><td>15</td><td>8000</td><td>0</td><td>5</td></tr><tr><th>7</th><td>27</td><td>8000</td><td>0</td><td>6</td></tr><tr><th>8</th><td>40</td><td>8000</td><td>0</td><td>7</td></tr><tr><th>9</th><td>74</td><td>8000</td><td>0</td><td>8</td></tr><tr><th>10</th><td>138</td><td>8000</td><td>0</td><td>9</td></tr></tbody></table><p>We now plot how quantities evolved in time to show the exponential growth of the virus</p><pre><code class="language-julia">N = sum(model.properties[:Ns]) # Total initial population
x = data.step
p = Plots.plot(x, log10.(data[:, Symbol(&quot;infected(status)&quot;)]), label = &quot;infected&quot;)
plot!(p, x, log10.(data[:, Symbol(&quot;recovered(status)&quot;)]), label = &quot;recovered&quot;)
dead = log10.(N .- data[:, Symbol(&quot;length(status)&quot;)])
plot!(p, x, dead, label = &quot;dead&quot;)
xlabel!(p, &quot;steps&quot;)
ylabel!(p, &quot;log( count )&quot;)
p</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewBox="0 0 2400 1600">
<defs>
  <clipPath id="clip1700">
    <rect x="0" y="0" width="2400" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1700)" d="
M0 1600 L2400 1600 L2400 0 L0 0  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1701">
    <rect x="480" y="0" width="1681" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip1700)" d="
M175.611 1425.62 L2352.76 1425.62 L2352.76 47.2441 L175.611 47.2441  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip1702">
    <rect x="175" y="47" width="2178" height="1379"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  237.228,1425.62 237.228,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  648.01,1425.62 648.01,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1058.79,1425.62 1058.79,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1469.57,1425.62 1469.57,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  1880.36,1425.62 1880.36,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  2291.14,1425.62 2291.14,47.2441 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.611,1386.61 2352.76,1386.61 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.611,1053.45 2352.76,1053.45 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.611,720.288 2352.76,720.288 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.611,387.128 2352.76,387.128 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#000000; stroke-width:2; stroke-opacity:0.1; fill:none" points="
  175.611,53.9682 2352.76,53.9682 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,1425.62 2352.76,1425.62 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,1425.62 175.611,47.2441 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  237.228,1425.62 237.228,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  648.01,1425.62 648.01,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1058.79,1425.62 1058.79,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1469.57,1425.62 1469.57,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1880.36,1425.62 1880.36,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  2291.14,1425.62 2291.14,1409.08 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,1386.61 201.736,1386.61 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,1053.45 201.736,1053.45 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,720.288 201.736,720.288 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,387.128 201.736,387.128 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  175.611,53.9682 201.736,53.9682 
  "/>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 237.228, 1479.62)" x="237.228" y="1479.62">0</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 648.01, 1479.62)" x="648.01" y="1479.62">10</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1058.79, 1479.62)" x="1058.79" y="1479.62">20</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1469.57, 1479.62)" x="1469.57" y="1479.62">30</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 1880.36, 1479.62)" x="1880.36" y="1479.62">40</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:middle;" transform="rotate(0, 2291.14, 1479.62)" x="2291.14" y="1479.62">50</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 151.611, 1404.11)" x="151.611" y="1404.11">0</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 151.611, 1070.95)" x="151.611" y="1070.95">1</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 151.611, 737.788)" x="151.611" y="737.788">2</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 151.611, 404.628)" x="151.611" y="404.628">3</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:end;" transform="rotate(0, 151.611, 71.4682)" x="151.611" y="71.4682">4</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(0, 1264.18, 1559.48)" x="1264.18" y="1559.48">steps</text>
</g>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:66px; text-anchor:middle;" transform="rotate(-90, 89.2861, 736.431)" x="89.2861" y="736.431">log( count )</text>
</g>
<polyline clip-path="url(#clip1702)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  237.228,1386.61 278.306,1386.61 319.384,1386.61 360.463,1127.36 401.541,1105.06 442.619,994.781 483.697,909.735 524.775,852.866 565.854,763.855 606.932,673.686 
  648.01,582.593 689.088,498.543 730.166,414.088 771.245,325.124 812.323,238.101 853.401,152.648 894.479,94.2677 935.558,86.2547 976.636,86.2547 1017.71,86.2547 
  1058.79,86.2547 1099.87,86.2547 1140.95,86.2547 1182.03,86.2547 1223.11,86.2547 1264.18,86.2547 1305.26,86.2547 1346.34,86.2547 1387.42,86.2547 1428.5,86.2547 
  1469.57,86.2547 1510.65,86.2547 1551.73,86.2547 1592.81,86.2547 1633.89,86.2728 1674.97,86.2728 1716.04,86.309 1757.12,86.3271 1798.2,86.309 1839.28,86.7983 
  1880.36,86.8165 1921.43,87.2711 1962.51,87.9832 2003.59,89.8808 2044.67,93.1632 2085.75,94.1912 2126.83,88.9381 2167.9,88.8092 2208.98,88.8092 2250.06,88.8092 
  2291.14,88.8092 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1633.89,1386.61 1674.97,1386.61 1716.04,1227.65 1757.12,1186.03 1798.2,1286.32 1839.28,899.396 1880.36,920.87 1921.43,826.486 1962.51,756.238 2003.59,653.191 
  2044.67,562.785 2085.75,556.586 2126.83,1105.06 
  "/>
<polyline clip-path="url(#clip1702)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  1798.2,1386.61 1839.28,1386.61 1880.36,1127.36 1921.43,1085.73 1962.51,976.672 2003.59,856.529 2044.67,759.996 2085.75,697.571 2126.83,671.604 2167.9,671.604 
  2208.98,671.604 2250.06,671.604 2291.14,671.604 
  "/>
<path clip-path="url(#clip1700)" d="
M1826.75 372.684 L2280.76 372.684 L2280.76 130.764 L1826.75 130.764  Z
  " fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip1700)" style="stroke:#000000; stroke-width:4; stroke-opacity:1; fill:none" points="
  1826.75,372.684 2280.76,372.684 2280.76,130.764 1826.75,130.764 1826.75,372.684 
  "/>
<polyline clip-path="url(#clip1700)" style="stroke:#009af9; stroke-width:4; stroke-opacity:1; fill:none" points="
  1850.75,191.244 1994.75,191.244 
  "/>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2018.75, 208.744)" x="2018.75" y="208.744">infected</text>
</g>
<polyline clip-path="url(#clip1700)" style="stroke:#e26f46; stroke-width:4; stroke-opacity:1; fill:none" points="
  1850.75,251.724 1994.75,251.724 
  "/>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2018.75, 269.224)" x="2018.75" y="269.224">recovered</text>
</g>
<polyline clip-path="url(#clip1700)" style="stroke:#3da44d; stroke-width:4; stroke-opacity:1; fill:none" points="
  1850.75,312.204 1994.75,312.204 
  "/>
<g clip-path="url(#clip1700)">
<text style="fill:#000000; fill-opacity:1; font-family:Arial,Helvetica Neue,Helvetica,sans-serif; font-size:48px; text-anchor:start;" transform="rotate(0, 2018.75, 329.704)" x="2018.75" y="329.704">dead</text>
</g>
</svg>
<p>The exponential growth is clearly visible since the logarithm of the  number of infected increases linearly, until everyone is infected.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../schelling/">« Schelling&#39;s segregation model</a><a class="docs-footer-nextpage" href="../wealth_distribution/">Wealth distribution »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 14 March 2020 15:31">Saturday 14 March 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
